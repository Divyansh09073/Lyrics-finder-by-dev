<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Lyrics Finder</title>
<style>
  body { background:#121212; color:#fff; font-family:Arial,sans-serif; display:flex; justify-content:center; padding:2rem; }
  .card { background:#1e1e1e; padding:2rem; border-radius:1rem; width:100%; max-width:600px; }
  input { width:70%; padding:0.75rem; border:none; border-radius:0.5rem; margin-right:0.5rem; }
  button { padding:0.75rem 1.5rem; background:#1db954; border:none; border-radius:0.5rem; cursor:pointer; color:#fff; }
  img { display:block; max-width:300px; margin:1rem auto; border-radius:0.75rem; }
  pre { background:#111; padding:1rem; border-radius:0.5rem; max-height:50vh; overflow:auto; white-space:pre-wrap; }
  .watermark { text-align:center; margin-top:1.5rem; color:#b3b3b3; }
</style>
</head>
<body>
<div class="card">
  <h1>Lyrics Finder üéµ</h1>
  <form id="searchForm">
    <input id="songInput" type="text" placeholder="Enter song name‚Ä¶" required />
    <button type="submit">Search</button>
  </form>
  <img id="cover" alt="Cover Art" style="display:none"/>
  <h2 id="songTitle"></h2>
  <pre id="lyrics"></pre>
  <p class="watermark">Made by Divyansh ‚ù§Ô∏è</p>
</div>

<script>
const apiBase = window.location.origin + '/api/lyrics?q=';
const form = document.getElementById('searchForm');
const songInput = document.getElementById('songInput');
const coverEl = document.getElementById('cover');
const titleEl = document.getElementById('songTitle');
const lyricsEl = document.getElementById('lyrics');

form.addEventListener('submit', async e => {
  e.preventDefault();
  const query = encodeURIComponent(songInput.value.trim());
  if (!query) return;
  titleEl.textContent = 'Loading...';
  lyricsEl.textContent = '';
  coverEl.style.display = 'none';

  try {
    const res = await fetch(apiBase + query);
    const data = await res.json();
    const lyrics = data.lyrics || data.result?.lyrics || 'No lyrics found.';
    const title = (data.title || data.result?.title || songInput.value);
    const artist = data.artist || data.result?.artist || '';
    titleEl.textContent = artist ? `${title} ‚Äî ${artist}` : title;
    lyricsEl.textContent = lyrics;

    let cover = data.albumArt || data.cover || data.thumbnail;
    if (!cover) {
      const itunes = await (await fetch(`https://itunes.apple.com/search?term=${query}&entity=song&limit=1`)).json();
      if (itunes.resultCount) {
        cover = itunes.results[0].artworkUrl100.replace(/100x100bb/, '500x500bb');
      }
    }
    if (cover) {
      coverEl.src = cover;
      coverEl.style.display = 'block';
    }
  } catch (err) {
    titleEl.textContent = 'Error';
    lyricsEl.textContent = 'Failed to fetch lyrics.';
  }
});
</script>
</body>
</html>
